/*C3*/SET SCHEMA PUBLIC
DROP TABLE SALEDELIVERY if exists
DROP TABLE SALE if exists
DROP TABLE ADDRESS if exists
DROP TABLE CUSTOMER if exists
CREATE TABLE CUSTOMER (ID INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1) PRIMARY KEY NOT NULL, DESIGNATION VARCHAR(50) NOT NULL, PHONENUMBER INTEGER, VATNUMBER INTEGER NOT NULL UNIQUE)
INSERT INTO CUSTOMER VALUES(1,'JOSE FARIA',914276732,197672337)
COMMIT
INSERT INTO CUSTOMER VALUES(2,'LUIS SANTOS',964294317,168027852)
COMMIT
CREATE TABLE SALE (ID INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1) PRIMARY KEY NOT NULL, DATE DATE, TOTAL DOUBLE, STATUS CHAR(1), CUSTOMER_VAT INTEGER)
CREATE TABLE ADDRESS (ID INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1) PRIMARY KEY NOT NULL, ADDRESS CHAR(100), CUSTOMER_VAT INTEGER)
CREATE TABLE SALEDELIVERY (ID INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1) PRIMARY KEY NOT NULL, SALE_ID INTEGER, CUSTOMER_VAT INTEGER, ADDRESS_ID INTEGER)
ALTER TABLE SALE ADD CONSTRAINT FK_SALE_CUSTOMER FOREIGN KEY (CUSTOMER_VAT) REFERENCES CUSTOMER(VATNUMBER) ON DELETE CASCADE
ALTER TABLE ADDRESS ADD CONSTRAINT FK_ADDRESS_CUSTOMER FOREIGN KEY (CUSTOMER_VAT) REFERENCES CUSTOMER(VATNUMBER) ON DELETE CASCADE
ALTER TABLE SALEDELIVERY ADD CONSTRAINT FK_SALEDELIVERY_CUSTOMER FOREIGN KEY (CUSTOMER_VAT) REFERENCES CUSTOMER(VATNUMBER) ON DELETE CASCADE
DISCONNECT
